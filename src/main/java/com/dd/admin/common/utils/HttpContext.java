package com.dd.admin.common.utils;import com.alibaba.fastjson.JSON;import com.alibaba.fastjson.serializer.SerializerFeature;import org.springframework.web.context.request.RequestContextHolder;import org.springframework.web.context.request.ServletRequestAttributes;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import java.io.IOException;import java.io.OutputStream;import java.util.Enumeration;import java.util.HashMap;import java.util.Map;/** * 快捷获取HttpServletRequest,HttpServletResponse * * @author stylefeng * @Date 2018/1/4 21:24 */public class HttpContext {    /**     * 判断是否是ajax请求     */    public static boolean isAjax(HttpServletRequest httpRequest) {        return (httpRequest.getHeader("X-Requested-With") != null                && "XMLHttpRequest"                .equalsIgnoreCase(httpRequest.getHeader("X-Requested-With").toString()));    }    public static void write(Object object) throws IOException {        HttpServletResponse response =  getResponse();        OutputStream out = null;        try {            response.reset();            response.setHeader("Access-Control-Allow-Origin", "*");            response.setHeader("Access-Control-Allow-Headers", "Content-Type,Content-Length, Authorization, Accept,X-Requested-With");            response.setHeader("Access-Control-Allow-Methods", "PUT,POST,GET,DELETE,OPTIONS");            response.setCharacterEncoding("UTF-8");            response.setContentType("application/json");            out = response.getOutputStream();            out.write(JSON.toJSONString(object, SerializerFeature.WriteMapNullValue).getBytes());        } catch (Exception e) {        } finally {            if (out != null) {                out.flush();                out.close();            }        }    }    /**     * 获取请求的ip地址     *     * @author fengshuonan     * @Date 2018/7/23 下午3:44     */    public static String getIp() {        HttpServletRequest request = getRequest();        if (request == null) {            return "127.0.0.1";        } else {            return request.getRemoteHost();        }    }    /**     * 获取当前请求的Request对象     *     * @author fengshuonan     * @Date 2018/7/23 下午3:44     */    public static HttpServletRequest getRequest() {        ServletRequestAttributes requestAttributes = (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();        if (requestAttributes == null) {            return null;        } else {            return requestAttributes.getRequest();        }    }    /**     * 获取当前请求的Response对象     *     * @author fengshuonan     * @Date 2018/7/23 下午3:44     */    public static HttpServletResponse getResponse() {        ServletRequestAttributes requestAttributes = (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();        if (requestAttributes == null) {            return null;        } else {            return requestAttributes.getResponse();        }    }    /**     * 获取所有请求的值     *     * @author fengshuonan     * @Date 2018/7/23 下午3:44     */    public static Map<String, String> getRequestParameters() {        HashMap<String, String> values = new HashMap<>();        HttpServletRequest request = getRequest();        if (request == null) {            return values;        }        Enumeration enums = request.getParameterNames();        while (enums.hasMoreElements()) {            String paramName = (String) enums.nextElement();            String paramValue = request.getParameter(paramName);            values.put(paramName, paramValue);        }        return values;    }}